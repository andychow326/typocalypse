name: CI
on:
  workflow_call:

jobs:
  ci-server:
    name: CI for server
    runs-on: ubuntu-22.04
    defaults:
      run:
        working-directory: ./server
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Setup bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: 1.0.36
      - name: Install dependencies
        run: bun install
      - name: Run CI Check
        run: make ci

  ci-client:
    name: CI for client
    runs-on: ubuntu-22.04
    defaults:
      run:
        working-directory: ./client
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Setup Godot toolkit
        uses: Scony/godot-gdscript-toolkit@master
      - run: gdlint .
      - run: gdformat --check .
